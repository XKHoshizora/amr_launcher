<launch>

    <arg name="custom_topics" default="false" doc="Whether to use custom topic names"/>
    <arg name="input_topic" default="/imu" doc="Custom input topic name"/>
    <arg name="output_topic" default="/imu_filtered" doc="Custom output topic name"/>

    <!-- IMU filter node -->
    <node pkg="amr_imu_filters" type="advanced_imu_filter" name="amr_imu_filter" output="screen">
        <!-- Filter parameters -->
        <param name="filter_type" value="EKF" />
        <param name="use_mag" value="false" />
        <param name="fixed_frame" value="odom" />

        <!-- Filter rates -->
        <param name="expected_publish_freq" value="20.0" />

        <!-- Complementary filter parameters -->
        <param name="alpha" value="0.96" />

        <!-- EKF parameters -->
        <param name="process_noise_gyro" value="0.0001" />
        <param name="process_noise_accel" value="0.001" />
        <param name="process_noise_bias" value="0.00001" />
        <param name="measurement_noise_accel" value="0.1" />
        <param name="measurement_noise_mag" value="0.01" />

        <!-- 静态检测参数 -->
        <param name="static_threshold" value="0.005" />
        <param name="static_samples" value="100" />

        <!-- Topic configuration -->
        <!-- 默认输入输出话题为 imu/data 和 imu/filtered -->
        <!-- 如果需要自定义话题名称,使用以下remap -->
        <remap from="imu/data" to="$(arg input_topic)" if="$(arg custom_topics)"/>
        <remap from="imu/filtered" to="$(arg output_topic)" if="$(arg custom_topics)"/>
    </node>

</launch>